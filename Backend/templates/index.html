<!DOCTYPE html>
<html>
  <head>
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
      <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
    <script src="https://unpkg.com/esri-leaflet@2.4.1/dist/esri-leaflet.js"
    integrity="sha512-xY2smLIHKirD03vHKDJ2u4pqeHA7OQZZ27EjtqmuhDguxiUvdsOuXMwkg16PQrm9cgTmXtoxA6kwr8KBy3cdcw=="
    crossorigin=""></script>
        <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.3.3/dist/esri-leaflet-geocoder.css"
    integrity="sha512-IM3Hs+feyi40yZhDH6kV8vQMg4Fh20s9OzInIIAc4nx7aMYMfo+IenRUekoYsHZqGkREUgx0VvlEsgm7nCDW9g=="
    crossorigin="">
  <script src="https://unpkg.com/esri-leaflet-geocoder@2.3.3/dist/esri-leaflet-geocoder.js"
    integrity="sha512-HrFUyCEtIpxZloTgEKKMq4RFYhxjJkCiF5sDxuAokklOeZ68U2NPfh4MFtyIVWlsKtVbK5GD2/JzFyAfvT5ejA=="
    crossorigin=""></script>
      <style>
      /* Set the size of the div element that contains the map */
     #mapid { height: 500px; }
    </style>
  </head>
  <body>
<div id="mapid"></div>
  <div id="current">Nothing yet</div>
<script>

	var mymap = L.map('mapid').setView([19.0492292, 72.8922557], 13);
	var popup = L.popup();
    var geocodeService = L.esri.Geocoding.geocodeService();

    var searchControl = L.esri.Geocoding.geosearch().addTo(mymap);

      // create an empty layer group to store the results and add it to the map
      var results = L.layerGroup().addTo(mymap);

      // listen for the results event and add every result to the map

	L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox/streets-v11',
		tileSize: 512,
		zoomOffset: -1
	}).addTo(mymap);

	var marker = new L.marker([19.0492292, 72.8922557],{
    draggable: true}).addTo(mymap);

	 searchControl.on("results", function (data) {
        results.clearLayers();
        for (var i = data.results.length - 1; i >= 0; i--) {
          results.addLayer(marker.setLatLng(data.results[i].latlng));
        }
      });

marker.on("drag", function(e) {
    var mark = e.target;
    var position = mark.getLatLng();
    mymap.panTo(new L.LatLng(position.lat, position.lng));
});

marker.on('dragend', function(event) {
  var latlng = event.target.getLatLng();
    geocodeService.reverse().latlng([latlng.lat,latlng.lng]).run(function (error, result) {
  if (error) {
    return;
  }
    document.getElementById("current").innerHTML = result.address.Match_addr;
});
});

function chooseAddr(lat1, lng1)
{
 marker.setLatLng([lat1, lng1]);
 mymap.panTo(new L.LatLng(lat1, lng1));
}

function myFunction(arr)
{
 var out = "";
 var i;

 if(arr.length > 0)
 {
  chooseAddr(arr[0].lat,arr[0].lon);
  document.getElementById('current').innerHTML = arr[0].display_name;
 }
 else
 {
  document.getElementById('current').innerHTML = "Sorry, no results...";
 }

}

function addr_search()
{
 var inp = "Andheri";
 var xmlhttp = new XMLHttpRequest();
 var url = "https://nominatim.openstreetmap.org/search?format=json&limit=3&q=" + inp;
 xmlhttp.onreadystatechange = function()
 {
   if (this.readyState == 4 && this.status == 200)
   {
    var myArr = JSON.parse(this.responseText);
    myFunction(myArr);
   }
 };
 xmlhttp.open("GET", url, true);
 xmlhttp.send();
}

addr_search();

</script>

</body>
</html>